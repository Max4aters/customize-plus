/*!
 * Spectrum Colorpicker: WordPress Customize Theme
 * @author PlusWP <dev@pluswp.com> (http://pluswp.com)
 */

$spectrum--gutter: 8px;
$spectrum--gutter-percentage: 4%;
$spectrum--sliders-thickness-percentage: 15%;
$spectrum--input-height: $WP--input-height;
$spectrum--input-height-md: $WP--input-height-md;
$spectrum--breakpoint-md: $WPcustomize--breakpoint-md;
$spectrum--input-danger-bg: $state--danger-bg;
$spectrum--input-danger-border: $state--danger-border;
$spectrum--border-radius: 3px;
$spectrum--box-shadow: inset 0 0 5px rgba(0,0,0,.4);

.sp-container {
  // override the crazy high Spectrum's z-index which creates problems
  z-index: 1;
  position: relative;
  width: 100%;
  box-sizing: border-box;
  padding: 0 $spectrum--gutter;
  max-width: 270px;
}

.sp-picker-container,
.sp-palette-container {
  width: 100%;
  padding: $spectrum--gutter 0 0;
}

// (from default theme)
.sp-preview,
.sp-thumb-el {
  position:relative;
}

// (from default theme)
.sp-preview-inner,
.sp-alpha-inner,
.sp-thumb-inner {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
}

// hide spectrum toggle arrow and previewer
.sp-dd,
.sp-replacer {
  display: none;
}

// make the color picker area a bit less tall
.sp-fill {
  padding-top: 70%;
}

// make the input fullwidth
input[type=text].sp-input {
  width: 100%;
  box-sizing: border-box;

  &.sp-validation-error {
    background: $spectrum--input-danger-bg;
    border-color: $spectrum--input-danger-border;
  }
}

// remove border and apply box-shadow, just like iris
.sp-color,
.sp-sat,
.sp-alpha {
  border-radius: $spectrum--border-radius;
  border: 0;
}
.sp-val,
.sp-hue,
.sp-clear,
.sp-alpha-inner {
  border-radius: $spectrum--border-radius;
  box-shadow: $spectrum--box-shadow;
  border: 0;
}

// cursors for color picker...
.sp-val {
  cursor: crosshair;
}
// ...and hue slider
.sp-hue {
  cursor: pointer;
}

// a bigger dragger with shadow
.sp-dragger {
  background: transparent;
  border: 5px solid #aaa;
  border-radius: 50%;
  border-color: rgba(128,128,128,.5);
  box-shadow: none;
  width: 8px; // iris' one is 12px
  height: 8px; // iris' one is 12px
  margin-top: 4px;
  margin-left: 4px;
  cursor: move;
  opacity: .5;

  &:hover {
    border-color: #999;
    opacity: .8;
    box-shadow: 0 0 2px rgba(0,0,0,.75);
  }

  &::after {
    content: " ";
    position: absolute;
    bottom: -4px;
    right: -4px;
    left: -4px;
    top: -4px;
    border: 3px solid #f9f9f9;
    border-color: rgba(255,255,255,.8);
    border-radius: 50%;
  }

  &:hover::after {
    border-color: #fff;
  }
}

// Just show the transparent background without the 'x' symbol
// Clear behaves like setting the color to transparent
.sp-alpha,
.sp-clear-display {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwH+YwCGIasIUwhT25BVBADtzYNYrHvv4gAAAABJRU5ErkJggg==);
  cursor: pointer;
}

// tweak the slider style to make it look like WordPress iris one
// @@wptight-css copied from .iris-picker .iris-slider-offset {} \\
.sp-slider {
  background: 0;
  margin: 0;
  right: -3px;
  left: -3px;
  border-style: solid;
  border-color: #aaa;
  border-width: 4px 3px;
  width: auto;
  height: 4px;
  margin-top: -2px;
  border-radius: 4px;
  box-shadow: 0 1px 2px rgba(0,0,0,.2);
  opacity: .9;
  cursor: ns-resize;

  &::before {
    content: "";
    position: absolute;
    left: -2px;
    right: -2px;
    top: -3px;
    bottom: -3px;
    border: 2px solid #fff;
    border-radius: 3px;
  }
}

// tweak the alpha slider
.sp-alpha {
  top: 100% + $spectrum--gutter-percentage;
  height: $spectrum--sliders-thickness-percentage;
  max-height: 24px;
}

// the alpha slider handle
.sp-alpha-handle {
  background: 0;
  margin: 0;
  top: -3px;
  bottom: -3px;
  border-style: solid;
  border-color: #aaa;
  border-width: 3px 4px;
  height: auto;
  width: 4px;
  margin-left: -4px;
  border-radius: 4px;
  box-shadow: 0 1px 2px rgba(0,0,0,.2);
  opacity: .9;
  cursor: ew-resize;

  &::before {
    content: "";
    position: absolute;
    top: -2px;
    bottom: -2px;
    left: -3px;
    right: -3px;
    border: 2px solid #fff;
    border-radius: 3px;
  }
}

// Position the clear button and the hue bar correctly
// when clear is enabled (`allowEmpty: true`)
.sp-clear-enabled {
  .sp-clear {
    top: 100% - $spectrum--sliders-thickness-percentage;
    height: $spectrum--sliders-thickness-percentage;
  }
  .sp-hue {
    top: 0;
    height: 100% - $spectrum--sliders-thickness-percentage - $spectrum--gutter-percentage;
  }

  // different position when also the alpha slider is enabled
  &.sp-alpha-enabled {
    .sp-clear {
      top: 100% + $spectrum--gutter-percentage;
    }
    .sp-hue {
      height: 100%;
    }
    .sp-alpha {
      width: 85%;
    }
  }
}

// make the slider area a little narrower
.sp-color {
  right: $spectrum--sliders-thickness-percentage;
}
.sp-clear-enabled .sp-clear,
.sp-hue {
  left: (100% - $spectrum--sliders-thickness-percentage) + $spectrum--gutter-percentage;
}

// distantiate the input from the color picker
.sp-top {
  margin-bottom: 1%; // @@hack \\

  .sp-alpha-enabled & {
    margin-bottom: $spectrum--sliders-thickness-percentage; // @@hack \\
  }
}

// remove first and last palette thumb's margins
.sp-thumb-el {
  &:first-child {
    margin-left: 0;
  }
  &:last-child {
    margin-right: 0;
  }
}

// palette is fullwidth
.sp-palette {
  max-width: none;

  // use a dashicon to indicate the selected palette thumbnail
  .sp-thumb-active .sp-thumb-inner:before {
    content: "\f147"; // 'yes'
    font-family: 'dashicons';
    text-align: center;
    font-size: 20px;
    line-height: 100%;
    color: #222;
  }
  .sp-thumb-dark.sp-thumb-active .sp-thumb-inner:before {
    color: #fff;
  }

  // palette thumb
  .sp-thumb-el {
    display: block;
    position: relative;
    float: left;
    width: 9%;
    height: 22px;
    margin: 1px;
    border: solid 2px transparent;
    cursor: pointer;

    &:hover,
    &.sp-thumb-active {
      border-color: $WP--link-color;
    }
  }
}

// make the more button look like a link
.sp-palette-toggle {
  display: block;
  width: 100%;
  padding: $spectrum--gutter 0 0;
  background: 0;
  border: 0;
  box-shadow: none;
  color: $WP--link-color;
  text-align: center;
  outline: none;
  cursor: pointer;

  &:hover {
    color: $WP--link-color-hover;
    text-decoration: underline;
  }
}

// show the initial value and the current one beside the input field
// `.sp-show-initial` is a custom class we add in the `show` callback of
// the spectrum options if the `showInitial` options has been set to true.
.sp-show-initial .sp-input-container {
  float: right;
  width: auto;
}
.sp-initial {
  overflow: hidden;

  .sp-palette-row-initial .sp-thumb-el:first-child .sp-thumb-inner {
    border-radius: $spectrum--border-radius 0 0 $spectrum--border-radius;
  }

  .sp-thumb-el {
    display: block;
    float: left;
    height: $spectrum--input-height;
    width: 50%;
    border: 0;
    cursor: pointer;

    @media (max-width: $spectrum--breakpoint-md) {
      height: $spectrum--input-height-md;
    }
  }
}
